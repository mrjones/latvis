package main

import (
	"github.com/mrjones/latvis/location"
	"github.com/mrjones/latvis/visualization"

	"log"
	"io/ioutil"
	"os"
	"strings"
	"strconv"
	"time"
)

type StaticHistorySource struct { }

func (s *StaticHistorySource) GetHistory(year int64, month int) (*location.History, os.Error) {
	log.Printf("GH")
	return nil, nil
}

func (s *StaticHistorySource) FetchRange(start, end time.Time) (*location.History, os.Error) {
	log.Printf("FR")
	h := make(location.History, 0)
	h = append(h, &location.Coordinate{Lat:41.3818500, Lng:-74.6860244})
	h = append(h, &location.Coordinate{Lat:41.3805003, Lng:-74.6873668})
	h = append(h, &location.Coordinate{Lat:41.3831983, Lng:-74.6846688})
	h = append(h, &location.Coordinate{Lat:41.3818486, Lng:-74.6860244})
	h = append(h, &location.Coordinate{Lat:41.3818500, Lng:-74.6860112})
	h = append(h, &location.Coordinate{Lat:40.7215350, Lng:-73.9956670})
	h = append(h, &location.Coordinate{Lat:40.7201860, Lng:-73.9970160})
	h = append(h, &location.Coordinate{Lat:40.7228840, Lng:-73.9943180})
	h = append(h, &location.Coordinate{Lat:40.7502050, Lng:-73.9953210})
	h = append(h, &location.Coordinate{Lat:40.7488560, Lng:-73.9966700})
	h = append(h, &location.Coordinate{Lat:40.7515540, Lng:-73.9939720})
	h = append(h, &location.Coordinate{Lat:40.8000713, Lng:-73.9677714})
	h = append(h, &location.Coordinate{Lat:40.7987223, Lng:-73.9691204})
	h = append(h, &location.Coordinate{Lat:40.8014203, Lng:-73.9664224})
	h = append(h, &location.Coordinate{Lat:40.8034463, Lng:-73.9381360})
	h = append(h, &location.Coordinate{Lat:40.8020932, Lng:-73.9394750})
	h = append(h, &location.Coordinate{Lat:40.8047911, Lng:-73.9367771})
	h = append(h, &location.Coordinate{Lat:40.8034380, Lng:-73.9381360})
	h = append(h, &location.Coordinate{Lat:40.8034463, Lng:-73.9381161})
	h = append(h, &location.Coordinate{Lat:40.8676881, Lng:-73.9208112})
	h = append(h, &location.Coordinate{Lat:40.8663391, Lng:-73.9221602})
	h = append(h, &location.Coordinate{Lat:40.8690371, Lng:-73.9194622})
	h = append(h, &location.Coordinate{Lat:40.8044190, Lng:-73.9660550})
	h = append(h, &location.Coordinate{Lat:40.8030700, Lng:-73.9674040})
	h = append(h, &location.Coordinate{Lat:40.8057680, Lng:-73.9647060})
	h = append(h, &location.Coordinate{Lat:40.8088167, Lng:-73.9450409})
	h = append(h, &location.Coordinate{Lat:40.8074677, Lng:-73.9463899})
	h = append(h, &location.Coordinate{Lat:40.8101657, Lng:-73.9436919})
	h = append(h, &location.Coordinate{Lat:40.8641549, Lng:-73.9187330})
	h = append(h, &location.Coordinate{Lat:40.8628059, Lng:-73.9200820})
	h = append(h, &location.Coordinate{Lat:40.8655039, Lng:-73.9173840})
	h = append(h, &location.Coordinate{Lat:40.7649300, Lng:-73.9779439})
	h = append(h, &location.Coordinate{Lat:40.7635810, Lng:-73.9792929})
	h = append(h, &location.Coordinate{Lat:40.7662790, Lng:-73.9765949})
	h = append(h, &location.Coordinate{Lat:40.7565040, Lng:-73.9814440})
	h = append(h, &location.Coordinate{Lat:40.7551550, Lng:-73.9827930})
	h = append(h, &location.Coordinate{Lat:40.7578530, Lng:-73.9800950})
	h = append(h, &location.Coordinate{Lat:40.7752581, Lng:-73.9474059})
	h = append(h, &location.Coordinate{Lat:40.7739091, Lng:-73.9487549})
	h = append(h, &location.Coordinate{Lat:40.7766071, Lng:-73.9460569})
	h = append(h, &location.Coordinate{Lat:40.7452410, Lng:-73.9904090})
	h = append(h, &location.Coordinate{Lat:40.7438920, Lng:-73.9917580})
	h = append(h, &location.Coordinate{Lat:40.7465900, Lng:-73.9890600})
	h = append(h, &location.Coordinate{Lat:40.7472393, Lng:-73.9771961})
	h = append(h, &location.Coordinate{Lat:40.7458903, Lng:-73.9785451})
	h = append(h, &location.Coordinate{Lat:40.7485883, Lng:-73.9758471})
	h = append(h, &location.Coordinate{Lat:40.7866789, Lng:-73.9501852})
	h = append(h, &location.Coordinate{Lat:40.7853299, Lng:-73.9515342})
	h = append(h, &location.Coordinate{Lat:40.7880279, Lng:-73.9488362})
	h = append(h, &location.Coordinate{Lat:40.7076612, Lng:-74.0068620})
	h = append(h, &location.Coordinate{Lat:40.7063122, Lng:-74.0082110})
	h = append(h, &location.Coordinate{Lat:40.7090102, Lng:-74.0055130})
	h = append(h, &location.Coordinate{Lat:40.7322535, Lng:-73.9874105})
	h = append(h, &location.Coordinate{Lat:40.7229330, Lng:-73.9969740})
	h = append(h, &location.Coordinate{Lat:40.7396729, Lng:-73.9798639})
	h = append(h, &location.Coordinate{Lat:40.7229330, Lng:-73.9969740})
	h = append(h, &location.Coordinate{Lat:40.7396729, Lng:-73.9798639})
	h = append(h, &location.Coordinate{Lat:40.7503724, Lng:-73.9719306})
	h = append(h, &location.Coordinate{Lat:40.7490234, Lng:-73.9732796})
	h = append(h, &location.Coordinate{Lat:40.7517214, Lng:-73.9705816})
	h = append(h, &location.Coordinate{Lat:40.8478674, Lng:-73.9381255})
	h = append(h, &location.Coordinate{Lat:40.8465184, Lng:-73.9394745})
	h = append(h, &location.Coordinate{Lat:40.8492164, Lng:-73.9367765})
	h = append(h, &location.Coordinate{Lat:40.7345860, Lng:-73.9919690})
	h = append(h, &location.Coordinate{Lat:40.7332370, Lng:-73.9933180})
	h = append(h, &location.Coordinate{Lat:40.7359350, Lng:-73.9906200})
	h = append(h, &location.Coordinate{Lat:40.7340801, Lng:-73.9890284})
	h = append(h, &location.Coordinate{Lat:40.7327235, Lng:-73.9903827})
	h = append(h, &location.Coordinate{Lat:40.7354214, Lng:-73.9876848})
	h = append(h, &location.Coordinate{Lat:40.7340648, Lng:-73.9890391})
	h = append(h, &location.Coordinate{Lat:40.7340801, Lng:-73.9890284})
	h = append(h, &location.Coordinate{Lat:40.7389968, Lng:-73.9930222})
	h = append(h, &location.Coordinate{Lat:40.7376540, Lng:-73.9943666})
	h = append(h, &location.Coordinate{Lat:40.7403520, Lng:-73.9916687})
	h = append(h, &location.Coordinate{Lat:40.7389968, Lng:-73.9930222})
	h = append(h, &location.Coordinate{Lat:40.7390092, Lng:-73.9930131})
	h = append(h, &location.Coordinate{Lat:40.7489149, Lng:-73.9725270})
	h = append(h, &location.Coordinate{Lat:40.7475659, Lng:-73.9738760})
	h = append(h, &location.Coordinate{Lat:40.7502639, Lng:-73.9711780})
	h = append(h, &location.Coordinate{Lat:40.7562186, Lng:-73.9940539})
	h = append(h, &location.Coordinate{Lat:40.7548696, Lng:-73.9954029})
	h = append(h, &location.Coordinate{Lat:40.7575676, Lng:-73.9927049})
	h = append(h, &location.Coordinate{Lat:40.7625270, Lng:-73.9900380})
	h = append(h, &location.Coordinate{Lat:40.7611780, Lng:-73.9913870})
	h = append(h, &location.Coordinate{Lat:40.7638760, Lng:-73.9886890})
	h = append(h, &location.Coordinate{Lat:40.7603651, Lng:-73.9700555})
	h = append(h, &location.Coordinate{Lat:40.7590161, Lng:-73.9714045})
	h = append(h, &location.Coordinate{Lat:40.7617141, Lng:-73.9687065})
	h = append(h, &location.Coordinate{Lat:40.7832829, Lng:-73.9780395})
	h = append(h, &location.Coordinate{Lat:40.7819339, Lng:-73.9793885})
	h = append(h, &location.Coordinate{Lat:40.7846319, Lng:-73.9766905})
	h = append(h, &location.Coordinate{Lat:40.7835269, Lng:-73.9778631})
	h = append(h, &location.Coordinate{Lat:40.7821779, Lng:-73.9792121})
	h = append(h, &location.Coordinate{Lat:40.7848759, Lng:-73.9765141})
	h = append(h, &location.Coordinate{Lat:40.8015122, Lng:-73.9609528})
	h = append(h, &location.Coordinate{Lat:40.8001632, Lng:-73.9623018})
	h = append(h, &location.Coordinate{Lat:40.8028612, Lng:-73.9596038})
	h = append(h, &location.Coordinate{Lat:40.7229620, Lng:-73.9945941})
	h = append(h, &location.Coordinate{Lat:40.7216130, Lng:-73.9959431})
	h = append(h, &location.Coordinate{Lat:40.7243110, Lng:-73.9932451})
	h = append(h, &location.Coordinate{Lat:40.7306800, Lng:-73.9924621})
	h = append(h, &location.Coordinate{Lat:40.7293310, Lng:-73.9938111})
	h = append(h, &location.Coordinate{Lat:40.7320290, Lng:-73.9911131})
	h = append(h, &location.Coordinate{Lat:40.7148723, Lng:-74.0109790})
	h = append(h, &location.Coordinate{Lat:40.7135233, Lng:-74.0123280})
	h = append(h, &location.Coordinate{Lat:40.7162213, Lng:-74.0096300})
	h = append(h, &location.Coordinate{Lat:40.7893554, Lng:-73.9740109})
	h = append(h, &location.Coordinate{Lat:40.7880064, Lng:-73.9753599})
	h = append(h, &location.Coordinate{Lat:40.7907044, Lng:-73.9726619})
	h = append(h, &location.Coordinate{Lat:40.7313210, Lng:-74.0002500})
	h = append(h, &location.Coordinate{Lat:40.7299720, Lng:-74.0015990})
	h = append(h, &location.Coordinate{Lat:40.7326700, Lng:-73.9989010})
	h = append(h, &location.Coordinate{Lat:40.7601561, Lng:-73.9831827})
	h = append(h, &location.Coordinate{Lat:40.7588071, Lng:-73.9845317})
	h = append(h, &location.Coordinate{Lat:40.7615051, Lng:-73.9818337})
	h = append(h, &location.Coordinate{Lat:40.7824737, Lng:-73.9811074})
	h = append(h, &location.Coordinate{Lat:40.7811247, Lng:-73.9824564})
	h = append(h, &location.Coordinate{Lat:40.7838227, Lng:-73.9797584})
	h = append(h, &location.Coordinate{Lat:40.7574278, Lng:-73.9936101})
	h = append(h, &location.Coordinate{Lat:40.7560788, Lng:-73.9949591})
	h = append(h, &location.Coordinate{Lat:40.7587768, Lng:-73.9922611})
	h = append(h, &location.Coordinate{Lat:40.7460028, Lng:-73.9797513})
	h = append(h, &location.Coordinate{Lat:40.7446538, Lng:-73.9811003})
	h = append(h, &location.Coordinate{Lat:40.7473518, Lng:-73.9784023})
	h = append(h, &location.Coordinate{Lat:40.7686865, Lng:-73.9551865})
	h = append(h, &location.Coordinate{Lat:40.7673375, Lng:-73.9565355})
	h = append(h, &location.Coordinate{Lat:40.7700355, Lng:-73.9538375})
	h = append(h, &location.Coordinate{Lat:40.7073778, Lng:-74.0025974})
	h = append(h, &location.Coordinate{Lat:40.7060288, Lng:-74.0039464})
	h = append(h, &location.Coordinate{Lat:40.7087268, Lng:-74.0012484})
	h = append(h, &location.Coordinate{Lat:40.7316738, Lng:-74.0033808})
	h = append(h, &location.Coordinate{Lat:40.7303248, Lng:-74.0047298})
	h = append(h, &location.Coordinate{Lat:40.7330228, Lng:-74.0020318})
	h = append(h, &location.Coordinate{Lat:40.7502050, Lng:-73.9953210})
	h = append(h, &location.Coordinate{Lat:40.7488560, Lng:-73.9966700})
	h = append(h, &location.Coordinate{Lat:40.7515540, Lng:-73.9939720})
	h = append(h, &location.Coordinate{Lat:40.7419828, Lng:-73.9972091})
	h = append(h, &location.Coordinate{Lat:40.7406296, Lng:-73.9985481})
	h = append(h, &location.Coordinate{Lat:40.7433275, Lng:-73.9958502})
	h = append(h, &location.Coordinate{Lat:40.7419743, Lng:-73.9972091})
	h = append(h, &location.Coordinate{Lat:40.7419828, Lng:-73.9971892})
	h = append(h, &location.Coordinate{Lat:40.7513040, Lng:-73.9803780})
	h = append(h, &location.Coordinate{Lat:40.7499550, Lng:-73.9817270})
	h = append(h, &location.Coordinate{Lat:40.7526530, Lng:-73.9790290})
	h = append(h, &location.Coordinate{Lat:40.7452410, Lng:-73.9904090})
	h = append(h, &location.Coordinate{Lat:40.7438920, Lng:-73.9917580})
	h = append(h, &location.Coordinate{Lat:40.7465900, Lng:-73.9890600})
	h = append(h, &location.Coordinate{Lat:40.7407646, Lng:-73.9916994})
	h = append(h, &location.Coordinate{Lat:40.7394156, Lng:-73.9930484})
	h = append(h, &location.Coordinate{Lat:40.7421136, Lng:-73.9903504})
	h = append(h, &location.Coordinate{Lat:40.7312387, Lng:-74.0066645})
	h = append(h, &location.Coordinate{Lat:40.7298906, Lng:-74.0080248})
	h = append(h, &location.Coordinate{Lat:40.7325885, Lng:-74.0053269})
	h = append(h, &location.Coordinate{Lat:40.7312387, Lng:-74.0066872})
	h = append(h, &location.Coordinate{Lat:40.7312404, Lng:-74.0066645})
	h = append(h, &location.Coordinate{Lat:40.7298600, Lng:-73.9941510})
	h = append(h, &location.Coordinate{Lat:40.7285110, Lng:-73.9955000})
	h = append(h, &location.Coordinate{Lat:40.7312090, Lng:-73.9928020})
	h = append(h, &location.Coordinate{Lat:40.7271490, Lng:-73.9874059})
	h = append(h, &location.Coordinate{Lat:40.7258000, Lng:-73.9887549})
	h = append(h, &location.Coordinate{Lat:40.7284980, Lng:-73.9860569})
	h = append(h, &location.Coordinate{Lat:40.7323270, Lng:-74.0008320})
	h = append(h, &location.Coordinate{Lat:40.7309780, Lng:-74.0021810})
	h = append(h, &location.Coordinate{Lat:40.7336760, Lng:-73.9994830})
	h = append(h, &location.Coordinate{Lat:40.7087374, Lng:-74.0053875})
	h = append(h, &location.Coordinate{Lat:40.7073884, Lng:-74.0067365})
	h = append(h, &location.Coordinate{Lat:40.7100864, Lng:-74.0040385})
	h = append(h, &location.Coordinate{Lat:40.7079943, Lng:-74.0131736})
	h = append(h, &location.Coordinate{Lat:40.7066453, Lng:-74.0145226})
	h = append(h, &location.Coordinate{Lat:40.7093433, Lng:-74.0118246})
	h = append(h, &location.Coordinate{Lat:40.7058930, Lng:-74.0123829})
	h = append(h, &location.Coordinate{Lat:40.7045440, Lng:-74.0137319})
	h = append(h, &location.Coordinate{Lat:40.7072420, Lng:-74.0110339})
	h = append(h, &location.Coordinate{Lat:40.7281543, Lng:-74.0019218})
	h = append(h, &location.Coordinate{Lat:40.7268053, Lng:-74.0032708})
	h = append(h, &location.Coordinate{Lat:40.7295033, Lng:-74.0005728})
	h = append(h, &location.Coordinate{Lat:40.7267460, Lng:-73.9863260})
	h = append(h, &location.Coordinate{Lat:40.7253970, Lng:-73.9876750})
	h = append(h, &location.Coordinate{Lat:40.7280950, Lng:-73.9849770})
	h = append(h, &location.Coordinate{Lat:40.7236210, Lng:-73.9885510})
	h = append(h, &location.Coordinate{Lat:40.7222720, Lng:-73.9899000})
	h = append(h, &location.Coordinate{Lat:40.7249700, Lng:-73.9872020})
	h = append(h, &location.Coordinate{Lat:40.7220275, Lng:-73.9964229})
	h = append(h, &location.Coordinate{Lat:40.7206722, Lng:-73.9977763})
	h = append(h, &location.Coordinate{Lat:40.7233702, Lng:-73.9950783})
	h = append(h, &location.Coordinate{Lat:40.7220149, Lng:-73.9964317})
	h = append(h, &location.Coordinate{Lat:40.7220275, Lng:-73.9964229})
	h = append(h, &location.Coordinate{Lat:40.7043259, Lng:-74.0101921})
	h = append(h, &location.Coordinate{Lat:40.7029769, Lng:-74.0115411})
	h = append(h, &location.Coordinate{Lat:40.7056749, Lng:-74.0088431})
	h = append(h, &location.Coordinate{Lat:40.7273080, Lng:-74.0004730})
	h = append(h, &location.Coordinate{Lat:40.7259590, Lng:-74.0018220})
	h = append(h, &location.Coordinate{Lat:40.7286570, Lng:-73.9991240})
	h = append(h, &location.Coordinate{Lat:40.7313210, Lng:-74.0002500})
	h = append(h, &location.Coordinate{Lat:40.7299720, Lng:-74.0015990})
	h = append(h, &location.Coordinate{Lat:40.7326700, Lng:-73.9989010})
	h = append(h, &location.Coordinate{Lat:40.7148723, Lng:-74.0109790})
	h = append(h, &location.Coordinate{Lat:40.7135233, Lng:-74.0123280})
	h = append(h, &location.Coordinate{Lat:40.7162213, Lng:-74.0096300})
	h = append(h, &location.Coordinate{Lat:40.7073778, Lng:-74.0025974})
	h = append(h, &location.Coordinate{Lat:40.7060288, Lng:-74.0039464})
	h = append(h, &location.Coordinate{Lat:40.7087268, Lng:-74.0012484})
	h = append(h, &location.Coordinate{Lat:40.7140442, Lng:-73.9872035})
	h = append(h, &location.Coordinate{Lat:40.7126952, Lng:-73.9885525})
	h = append(h, &location.Coordinate{Lat:40.7153932, Lng:-73.9858545})
	h = append(h, &location.Coordinate{Lat:40.7233280, Lng:-73.9826280})
	h = append(h, &location.Coordinate{Lat:40.7219790, Lng:-73.9839770})
	h = append(h, &location.Coordinate{Lat:40.7246770, Lng:-73.9812790})
	h = append(h, &location.Coordinate{Lat:40.7156255, Lng:-74.0072002})
	h = append(h, &location.Coordinate{Lat:40.7142765, Lng:-74.0085492})
	h = append(h, &location.Coordinate{Lat:40.7169745, Lng:-74.0058512})
	h = append(h, &location.Coordinate{Lat:40.7100610, Lng:-74.0104033})
	h = append(h, &location.Coordinate{Lat:40.7087120, Lng:-74.0117523})
	h = append(h, &location.Coordinate{Lat:40.7114100, Lng:-74.0090543})
	h = append(h, &location.Coordinate{Lat:40.7089229, Lng:-74.0118617})
	h = append(h, &location.Coordinate{Lat:40.7075696, Lng:-74.0132142})
	h = append(h, &location.Coordinate{Lat:40.7102675, Lng:-74.0105162})
	h = append(h, &location.Coordinate{Lat:40.7089142, Lng:-74.0118687})
	h = append(h, &location.Coordinate{Lat:40.7089229, Lng:-74.0118617})
	h = append(h, &location.Coordinate{Lat:40.7103868, Lng:-74.0164623})
	h = append(h, &location.Coordinate{Lat:40.7090378, Lng:-74.0178113})
	h = append(h, &location.Coordinate{Lat:40.7117358, Lng:-74.0151133})
	h = append(h, &location.Coordinate{Lat:40.7201479, Lng:-73.9959931})
	h = append(h, &location.Coordinate{Lat:40.7188065, Lng:-73.9973366})
	h = append(h, &location.Coordinate{Lat:40.7215044, Lng:-73.9946386})
	h = append(h, &location.Coordinate{Lat:40.7201479, Lng:-73.9959931})
	h = append(h, &location.Coordinate{Lat:40.7201630, Lng:-73.9959821})
	h = append(h, &location.Coordinate{Lat:40.7031485, Lng:-74.0110395})
	h = append(h, &location.Coordinate{Lat:40.7017995, Lng:-74.0123885})
	h = append(h, &location.Coordinate{Lat:40.7044975, Lng:-74.0096905})
	h = append(h, &location.Coordinate{Lat:40.7250212, Lng:-73.9970755})
	h = append(h, &location.Coordinate{Lat:40.7236770, Lng:-73.9984340})
	h = append(h, &location.Coordinate{Lat:40.7263749, Lng:-73.9957361})
	h = append(h, &location.Coordinate{Lat:40.7250212, Lng:-73.9970946})
	h = append(h, &location.Coordinate{Lat:40.7250307, Lng:-73.9970755})
	h = append(h, &location.Coordinate{Lat:40.7276953, Lng:-74.0053922})
	h = append(h, &location.Coordinate{Lat:40.7263463, Lng:-74.0067412})
	h = append(h, &location.Coordinate{Lat:40.7290443, Lng:-74.0040432})
	h = append(h, &location.Coordinate{Lat:40.7140442, Lng:-73.9872035})
	h = append(h, &location.Coordinate{Lat:40.7126952, Lng:-73.9885525})
	h = append(h, &location.Coordinate{Lat:40.7153932, Lng:-73.9858545})
	h = append(h, &location.Coordinate{Lat:40.7250870, Lng:-73.9917200})
	h = append(h, &location.Coordinate{Lat:40.7237380, Lng:-73.9930690})
	h = append(h, &location.Coordinate{Lat:40.7264360, Lng:-73.9903710})
	h = append(h, &location.Coordinate{Lat:40.7291490, Lng:-74.0050009})
	h = append(h, &location.Coordinate{Lat:40.7278000, Lng:-74.0063499})
	h = append(h, &location.Coordinate{Lat:40.7304980, Lng:-74.0036519})
	h = append(h, &location.Coordinate{Lat:40.7250632, Lng:-73.9976946})
	h = append(h, &location.Coordinate{Lat:40.7195190, Lng:-74.0045750})
	h = append(h, &location.Coordinate{Lat:40.7322149, Lng:-73.9917940})
	h = append(h, &location.Coordinate{Lat:40.7195190, Lng:-74.0045750})
	h = append(h, &location.Coordinate{Lat:40.7322149, Lng:-73.9917940})
	h = append(h, &location.Coordinate{Lat:40.7348815, Lng:-73.9828632})
	h = append(h, &location.Coordinate{Lat:40.7335325, Lng:-73.9842122})
	h = append(h, &location.Coordinate{Lat:40.7362305, Lng:-73.9815142})
	h = append(h, &location.Coordinate{Lat:40.7558892, Lng:-73.9674950})
	h = append(h, &location.Coordinate{Lat:40.7545402, Lng:-73.9688440})
	h = append(h, &location.Coordinate{Lat:40.7572382, Lng:-73.9661460})
	h = append(h, &location.Coordinate{Lat:40.7766464, Lng:-73.9555858})
	h = append(h, &location.Coordinate{Lat:40.7752974, Lng:-73.9569348})
	h = append(h, &location.Coordinate{Lat:40.7779954, Lng:-73.9542368})
	h = append(h, &location.Coordinate{Lat:40.7278450, Lng:-73.9793396})
	h = append(h, &location.Coordinate{Lat:40.7264960, Lng:-73.9806886})
	h = append(h, &location.Coordinate{Lat:40.7291940, Lng:-73.9779906})
	h = append(h, &location.Coordinate{Lat:40.7366997, Lng:-73.9955339})
	h = append(h, &location.Coordinate{Lat:40.7353507, Lng:-73.9968829})
	h = append(h, &location.Coordinate{Lat:40.7380487, Lng:-73.9941849})
	h = append(h, &location.Coordinate{Lat:40.7473380, Lng:-73.9850880})
	h = append(h, &location.Coordinate{Lat:40.7459890, Lng:-73.9864370})
	h = append(h, &location.Coordinate{Lat:40.7486870, Lng:-73.9837390})
	h = append(h, &location.Coordinate{Lat:40.7586857, Lng:-73.9852800})
	h = append(h, &location.Coordinate{Lat:40.7573305, Lng:-73.9866335})
	h = append(h, &location.Coordinate{Lat:40.7600284, Lng:-73.9839356})
	h = append(h, &location.Coordinate{Lat:40.7586732, Lng:-73.9852891})
	h = append(h, &location.Coordinate{Lat:40.7586857, Lng:-73.9852800})
	h = append(h, &location.Coordinate{Lat:40.7589993, Lng:-73.9686744})
	h = append(h, &location.Coordinate{Lat:40.7576503, Lng:-73.9700234})
	h = append(h, &location.Coordinate{Lat:40.7603483, Lng:-73.9673254})
	h = append(h, &location.Coordinate{Lat:40.7623342, Lng:-73.9590156})
	h = append(h, &location.Coordinate{Lat:40.7609852, Lng:-73.9603646})
	h = append(h, &location.Coordinate{Lat:40.7636832, Lng:-73.9576666})
	h = append(h, &location.Coordinate{Lat:40.7786243, Lng:-73.9774191})
	h = append(h, &location.Coordinate{Lat:40.7772753, Lng:-73.9787681})
	h = append(h, &location.Coordinate{Lat:40.7799733, Lng:-73.9760701})
	h = append(h, &location.Coordinate{Lat:40.8488781, Lng:-73.9340972})
	h = append(h, &location.Coordinate{Lat:40.8475255, Lng:-73.9354381})
	h = append(h, &location.Coordinate{Lat:40.8502235, Lng:-73.9327401})
	h = append(h, &location.Coordinate{Lat:40.8488709, Lng:-73.9340972})
	h = append(h, &location.Coordinate{Lat:40.8488781, Lng:-73.9340810})
	h = append(h, &location.Coordinate{Lat:40.7530327, Lng:-73.9738119})
	h = append(h, &location.Coordinate{Lat:40.7516775, Lng:-73.9751654})
	h = append(h, &location.Coordinate{Lat:40.7543754, Lng:-73.9724675})
	h = append(h, &location.Coordinate{Lat:40.7530202, Lng:-73.9738210})
	h = append(h, &location.Coordinate{Lat:40.7530327, Lng:-73.9738119})
	h = append(h, &location.Coordinate{Lat:40.7582270, Lng:-73.9883531})
	h = append(h, &location.Coordinate{Lat:40.7568780, Lng:-73.9897021})
	h = append(h, &location.Coordinate{Lat:40.7595760, Lng:-73.9870041})
	h = append(h, &location.Coordinate{Lat:40.7237117, Lng:-73.9850761})
	h = append(h, &location.Coordinate{Lat:40.7223627, Lng:-73.9864251})
	h = append(h, &location.Coordinate{Lat:40.7250607, Lng:-73.9837271})
	h = append(h, &location.Coordinate{Lat:40.7751640, Lng:-73.9806083})
	h = append(h, &location.Coordinate{Lat:40.7738150, Lng:-73.9819573})
	h = append(h, &location.Coordinate{Lat:40.7765130, Lng:-73.9792593})
	h = append(h, &location.Coordinate{Lat:40.7225320, Lng:-73.9886761})
	h = append(h, &location.Coordinate{Lat:40.7211852, Lng:-73.9900361})
	h = append(h, &location.Coordinate{Lat:40.7238832, Lng:-73.9873382})
	h = append(h, &location.Coordinate{Lat:40.7225320, Lng:-73.9886982})
	h = append(h, &location.Coordinate{Lat:40.7225364, Lng:-73.9886761})
	h = append(h, &location.Coordinate{Lat:40.7554209, Lng:-73.9930342})
	h = append(h, &location.Coordinate{Lat:40.7540719, Lng:-73.9943832})
	h = append(h, &location.Coordinate{Lat:40.7567699, Lng:-73.9916852})
	h = append(h, &location.Coordinate{Lat:40.7811543, Lng:-73.9491434})
	h = append(h, &location.Coordinate{Lat:40.7798053, Lng:-73.9504924})
	h = append(h, &location.Coordinate{Lat:40.7825033, Lng:-73.9477944})
	h = append(h, &location.Coordinate{Lat:40.7520657, Lng:-74.0535754})
	h = append(h, &location.Coordinate{Lat:40.7507167, Lng:-74.0549244})
	h = append(h, &location.Coordinate{Lat:40.7534147, Lng:-74.0522264})
	h = append(h, &location.Coordinate{Lat:40.7625379, Lng:-73.9856902})
	h = append(h, &location.Coordinate{Lat:40.7611889, Lng:-73.9870392})
	h = append(h, &location.Coordinate{Lat:40.7638869, Lng:-73.9843412})
	h = append(h, &location.Coordinate{Lat:40.7407646, Lng:-73.9916994})
	h = append(h, &location.Coordinate{Lat:40.7394156, Lng:-73.9930484})
	h = append(h, &location.Coordinate{Lat:40.7421136, Lng:-73.9903504})
	h = append(h, &location.Coordinate{Lat:40.7253880, Lng:-73.9842392})
	h = append(h, &location.Coordinate{Lat:40.7240390, Lng:-73.9855882})
	h = append(h, &location.Coordinate{Lat:40.7267370, Lng:-73.9828902})
	h = append(h, &location.Coordinate{Lat:40.7687894, Lng:-73.9887703})
	h = append(h, &location.Coordinate{Lat:40.7674445, Lng:-73.9901293})
	h = append(h, &location.Coordinate{Lat:40.7701425, Lng:-73.9874313})
	h = append(h, &location.Coordinate{Lat:40.7687894, Lng:-73.9887903})
	h = append(h, &location.Coordinate{Lat:40.7687976, Lng:-73.9887703})
	h = append(h, &location.Coordinate{Lat:40.8059276, Lng:-73.9413539})
	h = append(h, &location.Coordinate{Lat:40.8045786, Lng:-73.9427029})
	h = append(h, &location.Coordinate{Lat:40.8072766, Lng:-73.9400049})
	h = append(h, &location.Coordinate{Lat:40.8108388, Lng:-73.9530899})
	h = append(h, &location.Coordinate{Lat:40.8094898, Lng:-73.9544389})
	h = append(h, &location.Coordinate{Lat:40.8121878, Lng:-73.9517409})
	h = append(h, &location.Coordinate{Lat:40.8386060, Lng:-73.9410410})
	h = append(h, &location.Coordinate{Lat:40.8372570, Lng:-73.9423900})
	h = append(h, &location.Coordinate{Lat:40.8399550, Lng:-73.9396920})
	h = append(h, &location.Coordinate{Lat:40.8509893, Lng:-73.9387679})
	h = append(h, &location.Coordinate{Lat:40.8496403, Lng:-73.9401169})
	h = append(h, &location.Coordinate{Lat:40.8523383, Lng:-73.9374189})
	h = append(h, &location.Coordinate{Lat:40.7236773, Lng:-73.9789681})
	h = append(h, &location.Coordinate{Lat:40.7223283, Lng:-73.9803171})
	h = append(h, &location.Coordinate{Lat:40.7250263, Lng:-73.9776191})
	h = append(h, &location.Coordinate{Lat:40.7239834, Lng:-73.9929230})
	h = append(h, &location.Coordinate{Lat:40.7226344, Lng:-73.9942720})
	h = append(h, &location.Coordinate{Lat:40.7253324, Lng:-73.9915740})
	h = append(h, &location.Coordinate{Lat:40.7313152, Lng:-74.0029653})
	h = append(h, &location.Coordinate{Lat:40.7299662, Lng:-74.0043143})
	h = append(h, &location.Coordinate{Lat:40.7326642, Lng:-74.0016163})
	h = append(h, &location.Coordinate{Lat:40.7323954, Lng:-74.0037705})
	h = append(h, &location.Coordinate{Lat:40.7310464, Lng:-74.0051195})
	h = append(h, &location.Coordinate{Lat:40.7337444, Lng:-74.0024215})
	h = append(h, &location.Coordinate{Lat:40.7022052, Lng:-74.0021019})

	return &h, nil
}

type FileHistorySource struct { }

func (s *FileHistorySource) GetHistory(year int64, month int) (*location.History, os.Error) {
	log.Printf("GH")
	return nil, nil
}

func (s *FileHistorySource) FetchRange(start, end time.Time) (*location.History, os.Error) {
	b, err := ioutil.ReadFile("/home/mrjones/coffeelatlng.txt")
	if err != nil {
		panic(err)
	}
	str := string(b)
	h := make(location.History, 0)

	i := 0;
	lines := strings.Split(str, "\r\n");
	for _, line := range lines {
		if len(line) > 0 {
			i++
			latlng := strings.Split(line, "\t")
			lat, err := strconv.Atof64(latlng[0])
			if err != nil {
				log.Printf("Error with: %d -> %s", i,  latlng[0])
				panic(err)
			}
			lng, err := strconv.Atof64(latlng[1])
			if err != nil {
				log.Printf("Error converting %d [%s]\n", i, line)
				log.Printf("Error converting %d [%s]", i, latlng[1])
				panic(err)
			}
			h = append(h, &location.Coordinate{Lat: lat, Lng: lng})
		}
	}
	return &h, nil
}

func main() {
	var data location.HistorySource
//	data = &StaticHistorySource{}
	data = &FileHistorySource{}
//	http://latvis.mrjon.es/authorize
//?lllat=40.68820915280362&lllng=-74.03124499511716
//&urlat=40.86188317984097&urlng=-73.8959758300781
//&start=1296536400&end=1325394000

	bounds, err := location.NewBoundingBox(
		  location.Coordinate{Lat: 40.6882, Lng: -74.0312},
     	location.Coordinate{Lat: 40.861, Lng: -73.895})

	t := time.LocalTime();

	if err != nil {
		panic(err)
	}

	vis := visualization.NewVisualizer(
		512,
		&data,
		bounds,
		*t,
		*t)

	bytes, err := vis.Bytes()
	if err != nil {
		panic(err)
	}

	ioutil.WriteFile("/var/www/coffee.png", *bytes, 0777)
}
